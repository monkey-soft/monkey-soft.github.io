---
layout: post
title:  "盘点一些网站的反爬虫机制"
date:   2018-08-21 16:19:16
urlname: 76
cover: https://img.jikehou.cn/cover/2018-08-21.jpg
categories: [Python爬虫入门]
tags: [反爬虫]
keywords: [网络爬虫, 反爬虫]
---
因为 Python 语法简介以及强大的第三方库，所以我们使用它来制作网络爬虫程序。

网络爬虫的用途是进行数据采集，也就是将互联网中的数据采集过来。

网络爬虫的难点其实并不在于爬虫本身。

而是网站方为了避免数据被爬取，增加了各种各样的反爬虫措施。

如果想要继续从网站爬取数据就必须绕过这些措施。

因此，网络爬虫的难点在于反爬的攻克和处理。那么本文主要介绍一些网站的反爬虫措施。
<!-- more -->
## 1.妹子图

这个网站的反爬虫机制比较简单。

当我们使用网络请求库下载图片时，该网站会对检查每个 HTTP 请求的 headers 头部中 Referer 字段。

它判断该字段是否为空，如果字段为空，那么不会返回正常显示的图片，而是返回一张带有“图片来自妹子网，请勿盗链”字样的图片。

遇到这种机制，突破也是比较简单。对每个 HTTP 请求，将页面的 url 地址填充到 Referer 字段中。

## 2.豆瓣
几乎所有的爬虫新手都会爬取豆瓣练练手。但是豆瓣还是保持开放的态度，反爬虫机制做得还是很人性化。

它的反爬虫机制大概如下：

1、在没有携带 cookie 的情况下，如果某个 IP  短时间高并发请求网站，该 IP 会立马被封。当 IP 被封，登录豆瓣网站会解封。

2、在携带 cookie 的情况下，某个 IP 请求网站过于频繁。豆瓣的反爬虫机制变为只封 cookie 不封 IP。也就说退出登录或者换个账号还能继续访问网站。

面对这么体谅新手的网站，我们要下手不能那么猛。

我们只要在代码中登录账号，同时降低并发数，再随机延迟等待一段时间。

我们的爬虫程序就不会被封杀了。

## 3.拉勾网

拉勾网站刚出来的时候，反爬虫机制还没有现在这么严格。

估计爬取网站的人多了起来，网站管理员为了保护服务器增加一些手段。

该网站的反爬虫机制大概是这样子。

1、在没有登录的情况下，程序只能连续访问 3 个 Url。如果再继续访问，网站会将链接重定向，然后提示我们登录。

2、如果在登录情况下，连续请求部分 url 之后，我们的 IP 会被封。

针对这样的爬虫机制，我们只能使用 IP 代理池来突破。

## 4.汽车之家

汽车之家论坛的反爬虫机制就比较高级。它利用前端页面自定义字体的方式来实现反爬的技术手段。

具体使用到是 CSS3 中的自定义字体(`@font-face`)模块，自定义字体主要是实现将自定义的 Web 字体嵌入到指定网页中去。

这就导致我们去爬取论坛帖子的口碑时，获取到的返回文本中每隔几个字就出现一个乱码符号。

每次访问论坛页面，其中字体是不变的，但字符编码是变化的。

因此，我们需要根据每次访问动态解析字体文件。

具体可以先访问需要爬取的页面，获取字体文件的动态访问地址并下载字体，读取 js 渲染后的文本内容，替换其中的自定义字体编码为实际文本编码，就可复原网页为页面所见内容了。

</br>

最后说句良心话，我们爬取别人网站的数据，要在不损害别人网站的情况下进行。

所以建议大家不要在网站访问高峰的时候爬取数据，尽量选择在晚上进行爬取。

同时设置延时操作降低并发数。
